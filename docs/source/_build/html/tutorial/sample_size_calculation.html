<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sample size calculation for stage sampling &#8212; samplics 0.3.5 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/_source/samplics_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/samplics_style.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Selection of primary sampling units (PSUs)" href="psu_selection.html" />
    <link rel="prev" title="Tutorial" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Sample Analytics</a>
        <span class="navbar-text navbar-version pull-left"><b>0.3.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../gettingstarted.html">Getting started</a></li>
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="https://github.com/survey-methods/samplics">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">How to get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#datasets-for-the-tutorial">Datasets for the tutorial</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#sample-size-calculation">Sample size calculation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Sample size calculation for stage sampling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sample-selection">Sample selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="psu_selection.html">Selection of primary sampling units (PSUs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ssu_selection.html">Selection of secondary sampling units (SSUs)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sample-weighting">Sample weighting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sample_weights.html">Sample weight adjustment</a></li>
<li class="toctree-l3"><a class="reference internal" href="replicate_weights.html">Replicate weights</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#population-parameters-estimation">Population parameters estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="estimation.html">Estimation of population parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#categorical-data-analysis">Categorical data analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tabulation.html">Tabulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ttest.html">T-test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#small-area-estimation-sae">Small Area Estimation (SAE)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="eblup_area_model.html">Area level model: empirical best linear unbiased predictor (EBLUP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="eblup_unit_model.html">Unit level model: empirical best linear unbiased Prediction (EBLUP)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usecases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../samplics.sampling.html">Sampling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.sampling.html#module-samplics.sampling.selection">samplics.sampling.selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.weighting.html">Weighting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.weighting.html#module-samplics.weighting.adjustment">samplics.weighting.adjustment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.weighting.html#module-samplics.weighting.replicates">samplics.weighting.replicates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.estimation.html">Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.estimation.html#module-samplics.estimation.expansion">samplics.estimation.expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.estimation.html#module-samplics.estimation.regression">samplics.estimation.regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.estimation.html#module-samplics.estimation.replication">samplics.estimation.replication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.sae.html">Small Area Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.sae.html#samplics-sae-eb-area-model">samplics.sae.eb_area_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.sae.html#module-samplics.sae.eb_unit_model">samplics.sae.eb_unit_model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.utils.html">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.utils.html#module-samplics.utils.checks">samplics.utils.checks module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.utils.html#module-samplics.utils.formats">samplics.utils.formats module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.utils.html#module-samplics.utils.hadamard">samplics.utils.hadamard module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Sample-size-calculation-for-stage-sampling">
<h1>Sample size calculation for stage sampling<a class="headerlink" href="#Sample-size-calculation-for-stage-sampling" title="Permalink to this headline">¶</a></h1>
<p>In the cells below, we illustrate a simple example of sample size calculation in the context of household surveys using stage sampling designs. Let’s assume that we want to calculate sample size for a vaccination survey in Senegal. We want to stratify the sample by administrative region. We will use the 2017 Senegal Demographic and Health Survey (DHS) (see <a class="reference external" href="https://www.dhsprogram.com/publications/publication-FR345-DHS-Final-Reports.cfm">https://www.dhsprogram.com/publications/publication-FR345-DHS-Final-Reports.cfm</a>) to get an idea of the vaccination coverage rates for some
main vaccine-doses. Below, we show coverage rates of hepatitis B birth dose (hepB0) vaccine, first and third dose of diphtheria, tetanus and pertussis (DTP), first dose of measles containing vaccine (MCV1) and coverage of basic vaccination. Basic vaccination refers to the 12-23 months old children that received BCG vaccine, three doses of DTP containing vaccine, three doses of polio vaccine, and the first dose of measles containing vaccine.The table below shows the 2017 Senegal DHS vaccination
coverage of a few vaccine-doses for children aged 12 to 23 months old.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Region</p></th>
<th class="head"><p>HepB0</p></th>
<th class="head"><p>DTP1</p></th>
<th class="head"><p>DTP3</p></th>
<th class="head"><p>MCV1</p></th>
<th class="head"><p>Basic vaccination</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Dakar</p></td>
<td><p>53.6</p></td>
<td><p>99.1</p></td>
<td><p>98.5</p></td>
<td><p>97.0</p></td>
<td><p>84.9</p></td>
</tr>
<tr class="row-odd"><td><p>Ziguinchor</p></td>
<td><p>47.1</p></td>
<td><p>98.6</p></td>
<td><p>94.1</p></td>
<td><p>93.6</p></td>
<td><p>80.9</p></td>
</tr>
<tr class="row-even"><td><p>Diourbel</p></td>
<td><p>62.8</p></td>
<td><p>94.6</p></td>
<td><p>88.2</p></td>
<td><p>86.1</p></td>
<td><p>68.2</p></td>
</tr>
<tr class="row-odd"><td><p>Saint-Louis</p></td>
<td><p>40.1</p></td>
<td><p>99.1</p></td>
<td><p>97.2</p></td>
<td><p>94.7</p></td>
<td><p>80.6</p></td>
</tr>
<tr class="row-even"><td><p>Tambacounda</p></td>
<td><p>45.0</p></td>
<td><p>83.3</p></td>
<td><p>72.7</p></td>
<td><p>65.3</p></td>
<td><p>47.0</p></td>
</tr>
<tr class="row-odd"><td><p>Kaolack</p></td>
<td><p>63.9</p></td>
<td><p>99.6</p></td>
<td><p>92.2</p></td>
<td><p>89.3</p></td>
<td><p>79.7</p></td>
</tr>
<tr class="row-even"><td><p>Thies</p></td>
<td><p>62.3</p></td>
<td><p>100.0</p></td>
<td><p>98.8</p></td>
<td><p>91.6</p></td>
<td><p>83.4</p></td>
</tr>
<tr class="row-odd"><td><p>Louga</p></td>
<td><p>49.8</p></td>
<td><p>96.2</p></td>
<td><p>87.8</p></td>
<td><p>81.5</p></td>
<td><p>67.8</p></td>
</tr>
<tr class="row-even"><td><p>Fatick</p></td>
<td><p>62.7</p></td>
<td><p>98.5</p></td>
<td><p>93.8</p></td>
<td><p>90.3</p></td>
<td><p>76.6</p></td>
</tr>
<tr class="row-odd"><td><p>Kolda</p></td>
<td><p>32.8</p></td>
<td><p>94.4</p></td>
<td><p>87.3</p></td>
<td><p>85.6</p></td>
<td><p>63.7</p></td>
</tr>
<tr class="row-even"><td><p>Matam</p></td>
<td><p>43.1</p></td>
<td><p>94.3</p></td>
<td><p>88.1</p></td>
<td><p>79.4</p></td>
<td><p>68.7</p></td>
</tr>
<tr class="row-odd"><td><p>Kaffrine</p></td>
<td><p>56.9</p></td>
<td><p>98.0</p></td>
<td><p>93.6</p></td>
<td><p>88.7</p></td>
<td><p>76.6</p></td>
</tr>
<tr class="row-even"><td><p>Kedougou</p></td>
<td><p>44.4</p></td>
<td><p>70.7</p></td>
<td><p>60.2</p></td>
<td><p>46.5</p></td>
<td><p>33.6</p></td>
</tr>
<tr class="row-odd"><td><p>Sedhiou</p></td>
<td><p>46.6</p></td>
<td><p>96.8</p></td>
<td><p>90.4</p></td>
<td><p>89.9</p></td>
<td><p>74.2</p></td>
</tr>
</tbody>
</table>
<p>The 2017 Senegal DHS data collection happened from April to December 2018. Therefore, the data shown in the table represent children born from October 2016 to December 2017. For the purpose of this tutorial, we will assume that these vaccine coverage rates still hold. Furthermore, we will use the basic vaccination coverage rates to calculate sample size.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> lab_black

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">samplics</span>
<span class="kn">from</span> <span class="nn">samplics.sampling</span> <span class="kn">import</span> <span class="n">SampleSize</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/msdiallo/Dev/survey-methods/samplics/.venv/lib/python3.8/site-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
  import pandas.util.testing as tm
</pre></div></div>
</div>
<p>The first step is to create and object using the <em>SampleSize</em> class with the parameter of interest, the sample size calculation method, and the stratification status. In this example, we want to calculate sample size for proportions, using wald method for a stratified design. This is achived with the following snippet of code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SampleSize</span><span class="p">(</span>
    <span class="n">parameter</span><span class="o">=</span><span class="s2">&quot;proportion&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;wald&quot;</span><span class="p">,</span> <span class="n">stratification</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Because, we are using a stratified sample design, it is best to specify the expected coverage levels by stratum. If the information is not available then aggregated values can be used across the strata. The 2017 Senegal DHS published the coverage rates by region hence we have the information available by stratum. To provide the informmation to <em>Samplics</em> we use the python dictionaries as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expected_coverage</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Dakar&quot;</span><span class="p">:</span> <span class="mf">0.849</span><span class="p">,</span>
    <span class="s2">&quot;Ziguinchor&quot;</span><span class="p">:</span> <span class="mf">0.809</span><span class="p">,</span>
    <span class="s2">&quot;Diourbel&quot;</span><span class="p">:</span> <span class="mf">0.682</span><span class="p">,</span>
    <span class="s2">&quot;Saint-Louis&quot;</span><span class="p">:</span> <span class="mf">0.806</span><span class="p">,</span>
    <span class="s2">&quot;Tambacounda&quot;</span><span class="p">:</span> <span class="mf">0.470</span><span class="p">,</span>
    <span class="s2">&quot;Kaolack&quot;</span><span class="p">:</span> <span class="mf">0.797</span><span class="p">,</span>
    <span class="s2">&quot;Thies&quot;</span><span class="p">:</span> <span class="mf">0.834</span><span class="p">,</span>
    <span class="s2">&quot;Louga&quot;</span><span class="p">:</span> <span class="mf">0.678</span><span class="p">,</span>
    <span class="s2">&quot;Fatick&quot;</span><span class="p">:</span> <span class="mf">0.766</span><span class="p">,</span>
    <span class="s2">&quot;Kolda&quot;</span><span class="p">:</span> <span class="mf">0.637</span><span class="p">,</span>
    <span class="s2">&quot;Matam&quot;</span><span class="p">:</span> <span class="mf">0.687</span><span class="p">,</span>
    <span class="s2">&quot;Kaffrine&quot;</span><span class="p">:</span> <span class="mf">0.766</span><span class="p">,</span>
    <span class="s2">&quot;Kedougou&quot;</span><span class="p">:</span> <span class="mf">0.336</span><span class="p">,</span>
    <span class="s2">&quot;Sedhiou&quot;</span><span class="p">:</span> <span class="mf">0.742</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, we want to calculate the sample size with desired precision of 0.07 which means that we want the expected vaccination coverage rates to have 7% half confidence intervals e.g. expected rate of 90% will have a confidence interval of [83%, 97%]. Note that the desired precision can be specified by stratum in a similar way as the target coverage using a python dictionary.</p>
<p>Given that information, we can calculate the sample size using <em>SampleSize</em> class as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># target coverage rates</span>
<span class="n">expected_coverage</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Dakar&quot;</span><span class="p">:</span> <span class="mf">0.849</span><span class="p">,</span>
    <span class="s2">&quot;Ziguinchor&quot;</span><span class="p">:</span> <span class="mf">0.809</span><span class="p">,</span>
    <span class="s2">&quot;Diourbel&quot;</span><span class="p">:</span> <span class="mf">0.682</span><span class="p">,</span>
    <span class="s2">&quot;Saint-Louis&quot;</span><span class="p">:</span> <span class="mf">0.806</span><span class="p">,</span>
    <span class="s2">&quot;Tambacounda&quot;</span><span class="p">:</span> <span class="mf">0.470</span><span class="p">,</span>
    <span class="s2">&quot;Kaolack&quot;</span><span class="p">:</span> <span class="mf">0.797</span><span class="p">,</span>
    <span class="s2">&quot;Thies&quot;</span><span class="p">:</span> <span class="mf">0.834</span><span class="p">,</span>
    <span class="s2">&quot;Louga&quot;</span><span class="p">:</span> <span class="mf">0.678</span><span class="p">,</span>
    <span class="s2">&quot;Fatick&quot;</span><span class="p">:</span> <span class="mf">0.766</span><span class="p">,</span>
    <span class="s2">&quot;Kolda&quot;</span><span class="p">:</span> <span class="mf">0.637</span><span class="p">,</span>
    <span class="s2">&quot;Matam&quot;</span><span class="p">:</span> <span class="mf">0.687</span><span class="p">,</span>
    <span class="s2">&quot;Kaffrine&quot;</span><span class="p">:</span> <span class="mf">0.766</span><span class="p">,</span>
    <span class="s2">&quot;Kedougou&quot;</span><span class="p">:</span> <span class="mf">0.336</span><span class="p">,</span>
    <span class="s2">&quot;Sedhiou&quot;</span><span class="p">:</span> <span class="mf">0.742</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Declare the sample size calculation parameters</span>
<span class="n">sen_vaccine_wald</span> <span class="o">=</span> <span class="n">SampleSize</span><span class="p">(</span>
    <span class="n">parameter</span><span class="o">=</span><span class="s2">&quot;proportion&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;wald&quot;</span><span class="p">,</span> <span class="n">stratification</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># calculate the sample size</span>
<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">expected_coverage</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.07</span><span class="p">)</span>

<span class="c1"># show the calculated sample size</span>
<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">samp_size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;Dakar&#39;: 101,
 &#39;Ziguinchor&#39;: 122,
 &#39;Diourbel&#39;: 171,
 &#39;Saint-Louis&#39;: 123,
 &#39;Tambacounda&#39;: 196,
 &#39;Kaolack&#39;: 127,
 &#39;Thies&#39;: 109,
 &#39;Louga&#39;: 172,
 &#39;Fatick&#39;: 141,
 &#39;Kolda&#39;: 182,
 &#39;Matam&#39;: 169,
 &#39;Kaffrine&#39;: 141,
 &#39;Kedougou&#39;: 175,
 &#39;Sedhiou&#39;: 151}
</pre></div></div>
</div>
<p><em>SampleSize</em> calculates the sample sizes and store the in teh <em>samp_size</em> attributes which is a python dictinary object. If a dataframe is better suited for the use case, the method <em>to_dataframe()</em> can be used to create a pandas dataframe.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sen_vaccine_wald_size</span> <span class="o">=</span> <span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>

<span class="n">sen_vaccine_wald_size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_stratum</th>
      <th>_target</th>
      <th>_precision</th>
      <th>_samp_size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dakar</td>
      <td>0.849</td>
      <td>0.07</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ziguinchor</td>
      <td>0.809</td>
      <td>0.07</td>
      <td>122.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Diourbel</td>
      <td>0.682</td>
      <td>0.07</td>
      <td>171.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint-Louis</td>
      <td>0.806</td>
      <td>0.07</td>
      <td>123.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tambacounda</td>
      <td>0.470</td>
      <td>0.07</td>
      <td>196.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kaolack</td>
      <td>0.797</td>
      <td>0.07</td>
      <td>127.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thies</td>
      <td>0.834</td>
      <td>0.07</td>
      <td>109.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Louga</td>
      <td>0.678</td>
      <td>0.07</td>
      <td>172.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Fatick</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>141.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Kolda</td>
      <td>0.637</td>
      <td>0.07</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Matam</td>
      <td>0.687</td>
      <td>0.07</td>
      <td>169.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kaffrine</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>141.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kedougou</td>
      <td>0.336</td>
      <td>0.07</td>
      <td>175.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sedhiou</td>
      <td>0.742</td>
      <td>0.07</td>
      <td>151.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The sample size calculation above assumes that the design effect (DEFF) was equal to 1. A design effect of 1 correspond to sampling design with a variance equivalent to a simple random selection of same sample size. In the context of complex sampling designs, DEFF is often different from 1. Stage sampling and unequal weights usually increase the design effect above 1. The 2017 Senegal DHS indicated a design effect equal to 1.963 (1.401^2) for basic vaccination. Hence, to calculate the sample
size, we will use the design effect provided by DHS.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">expected_coverage</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">deff</span><span class="o">=</span><span class="mf">1.401</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_stratum</th>
      <th>_target</th>
      <th>_precision</th>
      <th>_samp_size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dakar</td>
      <td>0.849</td>
      <td>0.07</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ziguinchor</td>
      <td>0.809</td>
      <td>0.07</td>
      <td>238.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Diourbel</td>
      <td>0.682</td>
      <td>0.07</td>
      <td>334.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint-Louis</td>
      <td>0.806</td>
      <td>0.07</td>
      <td>241.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tambacounda</td>
      <td>0.470</td>
      <td>0.07</td>
      <td>384.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kaolack</td>
      <td>0.797</td>
      <td>0.07</td>
      <td>249.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thies</td>
      <td>0.834</td>
      <td>0.07</td>
      <td>214.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Louga</td>
      <td>0.678</td>
      <td>0.07</td>
      <td>336.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Fatick</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>276.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Kolda</td>
      <td>0.637</td>
      <td>0.07</td>
      <td>356.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Matam</td>
      <td>0.687</td>
      <td>0.07</td>
      <td>331.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kaffrine</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>276.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kedougou</td>
      <td>0.336</td>
      <td>0.07</td>
      <td>344.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sedhiou</td>
      <td>0.742</td>
      <td>0.07</td>
      <td>295.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Since the sample design is stratified, the sample size calculation will be more precised if DEFF is specified at the stratum level which is available from the 2017 Senegal DHS provided report. Some regions have a design effect below 1. To be conservative with our sample size calculation, we will use 1.21 as the minimum design effect to use in the sample size calculation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Target coverage rates</span>
<span class="n">expected_deff</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Dakar&quot;</span><span class="p">:</span> <span class="mf">1.100</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Ziguinchor&quot;</span><span class="p">:</span> <span class="mf">1.100</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Diourbel&quot;</span><span class="p">:</span> <span class="mf">1.346</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Saint-Louis&quot;</span><span class="p">:</span> <span class="mf">1.484</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Tambacounda&quot;</span><span class="p">:</span> <span class="mf">1.366</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Kaolack&quot;</span><span class="p">:</span> <span class="mf">1.360</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Thies&quot;</span><span class="p">:</span> <span class="mf">1.109</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Louga&quot;</span><span class="p">:</span> <span class="mf">1.902</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Fatick&quot;</span><span class="p">:</span> <span class="mf">1.100</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Kolda&quot;</span><span class="p">:</span> <span class="mf">1.217</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Matam&quot;</span><span class="p">:</span> <span class="mf">1.403</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Kaffrine&quot;</span><span class="p">:</span> <span class="mf">1.256</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Kedougou&quot;</span><span class="p">:</span> <span class="mf">2.280</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Sedhiou&quot;</span><span class="p">:</span> <span class="mf">1.335</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Calculate sample sizes using deff at the stratum level</span>
<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">expected_coverage</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">deff</span><span class="o">=</span><span class="n">expected_deff</span><span class="p">)</span>

<span class="c1"># Convert sample sizes to a dataframe</span>
<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_stratum</th>
      <th>_target</th>
      <th>_precision</th>
      <th>_samp_size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dakar</td>
      <td>0.849</td>
      <td>0.07</td>
      <td>122.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ziguinchor</td>
      <td>0.809</td>
      <td>0.07</td>
      <td>147.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Diourbel</td>
      <td>0.682</td>
      <td>0.07</td>
      <td>309.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint-Louis</td>
      <td>0.806</td>
      <td>0.07</td>
      <td>270.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tambacounda</td>
      <td>0.470</td>
      <td>0.07</td>
      <td>365.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kaolack</td>
      <td>0.797</td>
      <td>0.07</td>
      <td>235.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thies</td>
      <td>0.834</td>
      <td>0.07</td>
      <td>134.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Louga</td>
      <td>0.678</td>
      <td>0.07</td>
      <td>620.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Fatick</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>171.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Kolda</td>
      <td>0.637</td>
      <td>0.07</td>
      <td>269.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Matam</td>
      <td>0.687</td>
      <td>0.07</td>
      <td>332.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kaffrine</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>222.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kedougou</td>
      <td>0.336</td>
      <td>0.07</td>
      <td>910.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sedhiou</td>
      <td>0.742</td>
      <td>0.07</td>
      <td>268.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The sample size calculation above does not account for attrition of sample sizes due to non-response. In the 2017 Semegal DHS, the overal household and women reponse rate was abou 94.2%.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate sample sizes with a resp_rate of 94.2%</span>
<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span>
    <span class="n">target</span><span class="o">=</span><span class="n">expected_coverage</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">deff</span><span class="o">=</span><span class="n">expected_deff</span><span class="p">,</span> <span class="n">resp_rate</span><span class="o">=</span><span class="mf">0.942</span>
<span class="p">)</span>

<span class="c1"># Convert sample sizes to a dataframe</span>
<span class="n">sen_vaccine_wald</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span>
    <span class="n">col_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;vaccine_coverage&quot;</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="s2">&quot;number_12_23_months&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>vaccine_coverage</th>
      <th>precision</th>
      <th>number_12_23_months</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dakar</td>
      <td>0.849</td>
      <td>0.07</td>
      <td>130.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ziguinchor</td>
      <td>0.809</td>
      <td>0.07</td>
      <td>157.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Diourbel</td>
      <td>0.682</td>
      <td>0.07</td>
      <td>329.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint-Louis</td>
      <td>0.806</td>
      <td>0.07</td>
      <td>287.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tambacounda</td>
      <td>0.470</td>
      <td>0.07</td>
      <td>388.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kaolack</td>
      <td>0.797</td>
      <td>0.07</td>
      <td>250.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thies</td>
      <td>0.834</td>
      <td>0.07</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Louga</td>
      <td>0.678</td>
      <td>0.07</td>
      <td>659.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Fatick</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Kolda</td>
      <td>0.637</td>
      <td>0.07</td>
      <td>286.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Matam</td>
      <td>0.687</td>
      <td>0.07</td>
      <td>353.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kaffrine</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>236.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kedougou</td>
      <td>0.336</td>
      <td>0.07</td>
      <td>967.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sedhiou</td>
      <td>0.742</td>
      <td>0.07</td>
      <td>285.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="Fleiss-method">
<h2>Fleiss method<a class="headerlink" href="#Fleiss-method" title="Permalink to this headline">¶</a></h2>
<p>The World Health OR=rganization (WHO) recommends using the Fleiss method for calculating sample size for vaccination coverage survey (see <a class="reference external" href="https://www.who.int/immunization/documents/who_ivb_18.09/en/">https://www.who.int/immunization/documents/who_ivb_18.09/en/</a>). To use the Fleiss method, the examples shown above are the same with <em>method=“fleiss”</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sen_vaccine_fleiss</span> <span class="o">=</span> <span class="n">SampleSize</span><span class="p">(</span>
    <span class="n">parameter</span><span class="o">=</span><span class="s2">&quot;proportion&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fleiss&quot;</span><span class="p">,</span> <span class="n">stratification</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">sen_vaccine_fleiss</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span>
    <span class="n">target</span><span class="o">=</span><span class="n">expected_coverage</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">deff</span><span class="o">=</span><span class="n">expected_deff</span><span class="p">,</span> <span class="n">resp_rate</span><span class="o">=</span><span class="mf">0.942</span>
<span class="p">)</span>


<span class="n">sen_vaccine_sample</span> <span class="o">=</span> <span class="n">sen_vaccine_fleiss</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span>
    <span class="n">col_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;vaccine_coverage&quot;</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="s2">&quot;number_12_23_months&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sen_vaccine_sample</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>vaccine_coverage</th>
      <th>precision</th>
      <th>number_12_23_months</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dakar</td>
      <td>0.849</td>
      <td>0.07</td>
      <td>191.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ziguinchor</td>
      <td>0.809</td>
      <td>0.07</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Diourbel</td>
      <td>0.682</td>
      <td>0.07</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint-Louis</td>
      <td>0.806</td>
      <td>0.07</td>
      <td>385.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tambacounda</td>
      <td>0.470</td>
      <td>0.07</td>
      <td>410.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kaolack</td>
      <td>0.797</td>
      <td>0.07</td>
      <td>330.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thies</td>
      <td>0.834</td>
      <td>0.07</td>
      <td>201.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Louga</td>
      <td>0.678</td>
      <td>0.07</td>
      <td>795.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Fatick</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>229.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Kolda</td>
      <td>0.637</td>
      <td>0.07</td>
      <td>325.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Matam</td>
      <td>0.687</td>
      <td>0.07</td>
      <td>433.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kaffrine</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>298.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kedougou</td>
      <td>0.336</td>
      <td>0.07</td>
      <td>1141.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sedhiou</td>
      <td>0.742</td>
      <td>0.07</td>
      <td>349.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>At this point, we have the number of 12-23 months needed to achieve the desired precision given the expected proportions using wald or fleiss calculation methods.</p>
</div>
<div class="section" id="Number-of-households">
<h2>Number of households<a class="headerlink" href="#Number-of-households" title="Permalink to this headline">¶</a></h2>
<p>To obtain the number of households, we need to know the expected average number of children aged 12-23 months per household. This information can be obtained from census data or from surveys’ rosters. Since, the design is stratified, it is best to obtain the information per stratum. In this example, we wil assume that 5.2% of the population is between 12 and 23 months of age and apply that to all strata and household. Hence, the minimum number of households to select is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sen_vaccine_sample</span><span class="p">[</span><span class="s2">&quot;number_households&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
    <span class="n">sen_vaccine_sample</span><span class="p">[</span><span class="s2">&quot;number_12_23_months&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">0.052</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="n">sen_vaccine_sample</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>vaccine_coverage</th>
      <th>precision</th>
      <th>number_12_23_months</th>
      <th>number_households</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dakar</td>
      <td>0.849</td>
      <td>0.07</td>
      <td>191.0</td>
      <td>3673.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ziguinchor</td>
      <td>0.809</td>
      <td>0.07</td>
      <td>211.0</td>
      <td>4058.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Diourbel</td>
      <td>0.682</td>
      <td>0.07</td>
      <td>399.0</td>
      <td>7673.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint-Louis</td>
      <td>0.806</td>
      <td>0.07</td>
      <td>385.0</td>
      <td>7404.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tambacounda</td>
      <td>0.470</td>
      <td>0.07</td>
      <td>410.0</td>
      <td>7885.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kaolack</td>
      <td>0.797</td>
      <td>0.07</td>
      <td>330.0</td>
      <td>6346.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thies</td>
      <td>0.834</td>
      <td>0.07</td>
      <td>201.0</td>
      <td>3865.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Louga</td>
      <td>0.678</td>
      <td>0.07</td>
      <td>795.0</td>
      <td>15288.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Fatick</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>229.0</td>
      <td>4404.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Kolda</td>
      <td>0.637</td>
      <td>0.07</td>
      <td>325.0</td>
      <td>6250.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Matam</td>
      <td>0.687</td>
      <td>0.07</td>
      <td>433.0</td>
      <td>8327.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kaffrine</td>
      <td>0.766</td>
      <td>0.07</td>
      <td>298.0</td>
      <td>5731.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kedougou</td>
      <td>0.336</td>
      <td>0.07</td>
      <td>1141.0</td>
      <td>21942.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sedhiou</td>
      <td>0.742</td>
      <td>0.07</td>
      <td>349.0</td>
      <td>6712.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Similarly, the number of clusters to select can be obtained by dividing the number of households by the number of households per cluster to be selected.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019-2020, samplics.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>