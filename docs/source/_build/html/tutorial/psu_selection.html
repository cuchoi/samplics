<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Selection of primary sampling units (PSUs) &#8212; samplics 0.3.5 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/_source/samplics_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/samplics_style.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Selection of secondary sampling units (SSUs)" href="ssu_selection.html" />
    <link rel="prev" title="Sample size calculation for stage sampling" href="sample_size_calculation.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Sample Analytics</a>
        <span class="navbar-text navbar-version pull-left"><b>0.3.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../gettingstarted.html">Getting started</a></li>
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="https://github.com/survey-methods/samplics">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">How to get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#datasets-for-the-tutorial">Datasets for the tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sample-size-calculation">Sample size calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sample_size_calculation.html">Sample size calculation for stage sampling</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#sample-selection">Sample selection</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Selection of primary sampling units (PSUs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ssu_selection.html">Selection of secondary sampling units (SSUs)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sample-weighting">Sample weighting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sample_weights.html">Sample weight adjustment</a></li>
<li class="toctree-l3"><a class="reference internal" href="replicate_weights.html">Replicate weights</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#population-parameters-estimation">Population parameters estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="estimation.html">Estimation of population parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#categorical-data-analysis">Categorical data analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tabulation.html">Tabulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ttest.html">T-test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#small-area-estimation-sae">Small Area Estimation (SAE)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="eblup_area_model.html">Area level model: empirical best linear unbiased predictor (EBLUP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="eblup_unit_model.html">Unit level model: empirical best linear unbiased Prediction (EBLUP)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usecases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../samplics.sampling.html">Sampling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.sampling.html#module-samplics.sampling.selection">samplics.sampling.selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.weighting.html">Weighting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.weighting.html#module-samplics.weighting.adjustment">samplics.weighting.adjustment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.weighting.html#module-samplics.weighting.replicates">samplics.weighting.replicates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.estimation.html">Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.estimation.html#module-samplics.estimation.expansion">samplics.estimation.expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.estimation.html#module-samplics.estimation.regression">samplics.estimation.regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.estimation.html#module-samplics.estimation.replication">samplics.estimation.replication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.sae.html">Small Area Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.sae.html#samplics-sae-eb-area-model">samplics.sae.eb_area_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.sae.html#module-samplics.sae.eb_unit_model">samplics.sae.eb_unit_model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../samplics.utils.html">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../samplics.utils.html#module-samplics.utils.checks">samplics.utils.checks module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.utils.html#module-samplics.utils.formats">samplics.utils.formats module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../samplics.utils.html#module-samplics.utils.hadamard">samplics.utils.hadamard module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Selection-of-primary-sampling-units-(PSUs)">
<h1>Selection of primary sampling units (PSUs)<a class="headerlink" href="#Selection-of-primary-sampling-units-(PSUs)" title="Permalink to this headline">¶</a></h1>
<p>In the sections below, we draw primary sampling units (PSUs) using probability proportional to size (PPS) sampling techniques implemented in the <em>Sample</em> class. The class <em>Sample</em> has two main methods that is <em>inclusion_probs</em> and <em>select</em>. The method <em>inclusion_probs()</em> computes the probability of selection and <em>select()</em> draws the random samples.</p>
<p>The following will illustrate the use of samplics for sample selection. For the illustration, - We consider a stratified cluster design. - We will a priori decide how many PSUs to sample from each stratum - For the clusters selection, we demonstrate PPS methods</p>
<p>This example is not meant to be exhaustif. There are many use cases that are not covered in this tutorial. For example, some PSUs may be segmented due to their size and segments selected in a subsequent step. Segment selection can be done with Samplics in a similar way as the PSUs selection, with PPS or SRS, after the segements have been created by the user.</p>
<p>First, let us import the python packages necessary to run the tutorial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">samplics</span>
<span class="kn">from</span> <span class="nn">samplics.datasets</span> <span class="kn">import</span> <span class="n">PSUFrame</span>
<span class="kn">from</span> <span class="nn">samplics.sampling</span> <span class="kn">import</span> <span class="n">SampleSelection</span>
</pre></div>
</div>
</div>
<div class="section" id="Sample-Dataset">
<h2>Sample Dataset<a class="headerlink" href="#Sample-Dataset" title="Permalink to this headline">¶</a></h2>
<p>The file <em>sample_frame.csv</em> - shown below - contains synthetic data of 100 clusters classified by region (East, North, South and West). Clusters represent a group of households. In the file, each cluster has an associated number of households (number_households) and a status variable indicating whether the cluster is in scope or not.</p>
<p>This synthetic data represents a simplified version of enumeration areas (EAs) frames found in many countries and used by major household survey programs such as the Demographic and Health Surveys (DHS), the Population-based HIV Impact Assessment (PHIA) surveys and the Multiple Cluster Indicator Surveys (MICS).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">psu_frame_cls</span> <span class="o">=</span> <span class="n">PSUFrame</span><span class="p">()</span>
<span class="n">psu_frame_cls</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="n">psu_frame</span> <span class="o">=</span> <span class="n">psu_frame_cls</span><span class="o">.</span><span class="n">data</span>
<span class="n">psu_frame</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cluster</th>
      <th>region</th>
      <th>number_households_census</th>
      <th>cluster_status</th>
      <th>comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>North</td>
      <td>105</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>North</td>
      <td>85</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>North</td>
      <td>95</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>North</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>North</td>
      <td>120</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>North</td>
      <td>90</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>North</td>
      <td>130</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>North</td>
      <td>55</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>North</td>
      <td>30</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>North</td>
      <td>600</td>
      <td>1</td>
      <td>due to a large building</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>South</td>
      <td>25</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>South</td>
      <td>250</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>South</td>
      <td>105</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>South</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>South</td>
      <td>205</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>South</td>
      <td>190</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td>South</td>
      <td>95</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>18</td>
      <td>South</td>
      <td>85</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>19</td>
      <td>South</td>
      <td>50</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>20</td>
      <td>South</td>
      <td>110</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>21</td>
      <td>South</td>
      <td>130</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>22</td>
      <td>South</td>
      <td>180</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>23</td>
      <td>South</td>
      <td>65</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>24</td>
      <td>South</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>25</td>
      <td>South</td>
      <td>95</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Often, sampling frames are not available for the sampling units of interest. For example, most countries do not have a list of all households or people living in the country. Even if such frames exist, it may not be operationally and financially feasible to directly select sampling units without any form of clustering.</p>
<p>Hence, stage sampling is a common strategy used by large household national surveys for selecting samples of households and people. At the first stage, geographic or administrative clusters of households are selected. At the second stage, a frame of households is created from the selected clusters and a sample of households is selected. At the third stage (if applicable), a sample of people is selected from the households in the sample. This is a high level description of the process; usually
implementations are much less straightforward and may require many adjustments to address complexities.</p>
</div>
<div class="section" id="PSU-Probability-of-Selection">
<h2>PSU Probability of Selection<a class="headerlink" href="#PSU-Probability-of-Selection" title="Permalink to this headline">¶</a></h2>
<p>At the first stage, we use the proportional to size (pps) method to select a random sample of clusters. The measure of size is the number of households (number_households) as provided in the psu sampling frame. The sample is stratified by region. The probabilities, for stratified pps, is obtained as follow: <span class="math">\begin{equation} p_{hi} = \frac{n_h M_{hi}}{\sum_{i=1}^{N_h}{M_{hi}}} \end{equation}</span> where <span class="math notranslate nohighlight">\(p_{hi}\)</span> is the probability of selection for unit <span class="math notranslate nohighlight">\(i\)</span> from stratum
<span class="math notranslate nohighlight">\(h\)</span>, <span class="math notranslate nohighlight">\(M_{hi}\)</span> is the measure of size (mos), <span class="math notranslate nohighlight">\(n_h\)</span> and <span class="math notranslate nohighlight">\(N_h\)</span> are the sample size and the total number of clusters in stratum <span class="math notranslate nohighlight">\(h\)</span>, respectively.</p>
<p><strong>Important.</strong> The pps method is used in many surveys not just for multistage household surveys. For example, in business surveys, establishments can greatly vary in size; hence pps methods are often use to select samples. Simarly, facility-based surveys can benefit from pps methods when frames with measures of size are available.</p>
</div>
<div class="section" id="PSU-Sample-size">
<h2>PSU Sample size<a class="headerlink" href="#PSU-Sample-size" title="Permalink to this headline">¶</a></h2>
<p>For a stratified sampling design, the sample size is provided using a Python dictionary. Python dictionaries allow us to pair the strata with the sample sizes. Let’s say that we want to select 3 clusters from stratum <em>East</em>, 2 from <em>West</em>, 2 from <em>North</em> and 3 from <em>South</em>. The snippet of code below demonstrates how to create the Python dictionary. Note that it is important to correctly spell out the keys of the dictionary which corresponds to the values of the variable stratum (in our case it’s
<em>region</em>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">psu_sample_size</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;East&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;North&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;South&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The sample size per domain is: </span><span class="si">{</span><span class="n">psu_sample_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

The sample size per domain is: {&#39;East&#39;: 3, &#39;West&#39;: 2, &#39;North&#39;: 2, &#39;South&#39;: 3}

</pre></div></div>
</div>
<p>The function <em>array_to_dict()</em> converts an array to a dictionnary by pairing the values of the array to their frequency. We can use this function to calculates the number of clusters per stratum and store the result in a Python dictionnary. Then, we modify the values of the dictionnary to create the sample size dictionnary.</p>
<p>If some of the clusters are certainties then an exception will be raised. Hence, the user will have to manually handle the certaininties. Better handling of certainties is planned for future versions of the library <em>samplics</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">samplics</span> <span class="kn">import</span> <span class="n">array_to_dict</span>

<span class="n">frame_size</span> <span class="o">=</span> <span class="n">array_to_dict</span><span class="p">(</span><span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The number of clusters per stratum is: </span><span class="si">{</span><span class="n">frame_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">psu_sample_size</span> <span class="o">=</span> <span class="n">frame_size</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">psu_sample_size</span><span class="p">[</span><span class="s2">&quot;East&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">psu_sample_size</span><span class="p">[</span><span class="s2">&quot;North&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">psu_sample_size</span><span class="p">[</span><span class="s2">&quot;South&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">psu_sample_size</span><span class="p">[</span><span class="s2">&quot;West&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The sample size per stratum is: </span><span class="si">{</span><span class="n">psu_sample_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

The number of clusters per stratum is: {&#39;East&#39;: 25, &#39;North&#39;: 10, &#39;South&#39;: 20, &#39;West&#39;: 45}

The sample size per stratum is: {&#39;East&#39;: 3, &#39;North&#39;: 2, &#39;South&#39;: 3, &#39;West&#39;: 2}

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stage1_design</span> <span class="o">=</span> <span class="n">SampleSelection</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-sys&quot;</span><span class="p">,</span> <span class="n">stratification</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;psu_prob&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stage1_design</span><span class="o">.</span><span class="n">inclusion_probs</span><span class="p">(</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">],</span>
    <span class="n">psu_sample_size</span><span class="p">,</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">],</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;number_households_census&quot;</span><span class="p">],</span>
    <span class="p">)</span>

<span class="n">nb_obs</span> <span class="o">=</span> <span class="mi">15</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">First </span><span class="si">{</span><span class="n">nb_obs</span><span class="si">}</span><span class="s2"> observations of the PSU frame </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">psu_frame</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">nb_obs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

First 15 observations of the PSU frame

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cluster</th>
      <th>region</th>
      <th>number_households_census</th>
      <th>cluster_status</th>
      <th>comment</th>
      <th>psu_prob</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>North</td>
      <td>105</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.151625</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>North</td>
      <td>85</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.122744</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>North</td>
      <td>95</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.137184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>North</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.108303</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>North</td>
      <td>120</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.173285</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>North</td>
      <td>90</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.129964</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>North</td>
      <td>130</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.187726</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>North</td>
      <td>55</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.079422</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>North</td>
      <td>30</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.043321</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>North</td>
      <td>600</td>
      <td>1</td>
      <td>due to a large building</td>
      <td>0.866426</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>South</td>
      <td>25</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.027523</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>South</td>
      <td>250</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.275229</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>South</td>
      <td>105</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.115596</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>South</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.082569</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>South</td>
      <td>205</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.225688</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="PSU-Selection">
<h2>PSU Selection<a class="headerlink" href="#PSU-Selection" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">In this section, we select a sample of psus using pps methods. In the section above, we have calculated the probabilities of selection. That step is not necessary when using <em>samplics</em>. We can use the method <em>select()</em> to calculate the probability of selection and select the sample, in one run. As shown below, <em>select()</em> method returns a tuple of three arrays.</div>
<div class="line">* The first array indicates the selected units (i.e. psu_sample = 1 if selected, and 0 if not selected).</div>
<div class="line">* The second array provides the number of hits, useful when the sample is selected with replacement.</div>
<div class="line">* The third array is the probability of selection.</div>
</div>
<p>NB: <em>np.random.seed()</em> fixes the random seed to allow us to reproduce the random selection.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>

<span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;psu_sample&quot;</span><span class="p">],</span> <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;psu_hits&quot;</span><span class="p">],</span> <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;psu_probs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stage1_design</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">],</span>
    <span class="n">psu_sample_size</span><span class="p">,</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">],</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;number_households_census&quot;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="n">nb_obs</span> <span class="o">=</span> <span class="mi">15</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">First </span><span class="si">{</span><span class="n">nb_obs</span><span class="si">}</span><span class="s2"> observations of the PSU frame with the sampling information </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">psu_frame</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">nb_obs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

First 15 observations of the PSU frame with the sampling information

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cluster</th>
      <th>region</th>
      <th>number_households_census</th>
      <th>cluster_status</th>
      <th>comment</th>
      <th>psu_prob</th>
      <th>psu_sample</th>
      <th>psu_hits</th>
      <th>psu_probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>North</td>
      <td>105</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.151625</td>
      <td>0</td>
      <td>0</td>
      <td>0.151625</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>North</td>
      <td>85</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.122744</td>
      <td>0</td>
      <td>0</td>
      <td>0.122744</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>North</td>
      <td>95</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.137184</td>
      <td>0</td>
      <td>0</td>
      <td>0.137184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>North</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.108303</td>
      <td>0</td>
      <td>0</td>
      <td>0.108303</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>North</td>
      <td>120</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.173285</td>
      <td>0</td>
      <td>0</td>
      <td>0.173285</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>North</td>
      <td>90</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.129964</td>
      <td>0</td>
      <td>0</td>
      <td>0.129964</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>North</td>
      <td>130</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.187726</td>
      <td>1</td>
      <td>1</td>
      <td>0.187726</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>North</td>
      <td>55</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.079422</td>
      <td>0</td>
      <td>0</td>
      <td>0.079422</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>North</td>
      <td>30</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.043321</td>
      <td>0</td>
      <td>0</td>
      <td>0.043321</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>North</td>
      <td>600</td>
      <td>1</td>
      <td>due to a large building</td>
      <td>0.866426</td>
      <td>1</td>
      <td>1</td>
      <td>0.866426</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>South</td>
      <td>25</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.027523</td>
      <td>0</td>
      <td>0</td>
      <td>0.027523</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>South</td>
      <td>250</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.275229</td>
      <td>0</td>
      <td>0</td>
      <td>0.275229</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>South</td>
      <td>105</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.115596</td>
      <td>0</td>
      <td>0</td>
      <td>0.115596</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>South</td>
      <td>75</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.082569</td>
      <td>0</td>
      <td>0</td>
      <td>0.082569</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>South</td>
      <td>205</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.225688</td>
      <td>0</td>
      <td>0</td>
      <td>0.225688</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The default setting <code class="docutils literal notranslate"><span class="pre">sample_only=False</span></code> returns the entire frame. We can easily reduce the output data to the sample by filtering i.e. <code class="docutils literal notranslate"><span class="pre">psu_sample</span> <span class="pre">==</span> <span class="pre">1</span></code>. However, if we are only interested in the sample, we could use <code class="docutils literal notranslate"><span class="pre">sample_only=True</span></code> when calling <em>select()</em>. This will reduce the output data to the sampled units and <code class="docutils literal notranslate"><span class="pre">to_dataframe=true</span></code> will convert the data to a pandas dataframe (pd.DataFrame). Note that the columns in the dataframe will be reduced to the minimum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>

<span class="n">psu_sample</span> <span class="o">=</span> <span class="n">stage1_design</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">],</span>
    <span class="n">psu_sample_size</span><span class="p">,</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">],</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;number_households_census&quot;</span><span class="p">],</span>
    <span class="n">to_dataframe</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sample_only</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">PSU sample without the non-sampled units</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">psu_sample</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

PSU sample without the non-sampled units

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_samp_unit</th>
      <th>_stratum</th>
      <th>_mos</th>
      <th>_sample</th>
      <th>_hits</th>
      <th>_probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>North</td>
      <td>130</td>
      <td>1</td>
      <td>1</td>
      <td>0.187726</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>North</td>
      <td>600</td>
      <td>1</td>
      <td>1</td>
      <td>0.866426</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16</td>
      <td>South</td>
      <td>190</td>
      <td>1</td>
      <td>1</td>
      <td>0.209174</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>South</td>
      <td>75</td>
      <td>1</td>
      <td>1</td>
      <td>0.082569</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29</td>
      <td>South</td>
      <td>200</td>
      <td>1</td>
      <td>1</td>
      <td>0.220183</td>
    </tr>
    <tr>
      <th>5</th>
      <td>34</td>
      <td>East</td>
      <td>305</td>
      <td>1</td>
      <td>1</td>
      <td>0.210587</td>
    </tr>
    <tr>
      <th>6</th>
      <td>45</td>
      <td>East</td>
      <td>450</td>
      <td>1</td>
      <td>1</td>
      <td>0.310702</td>
    </tr>
    <tr>
      <th>7</th>
      <td>52</td>
      <td>East</td>
      <td>700</td>
      <td>1</td>
      <td>1</td>
      <td>0.483314</td>
    </tr>
    <tr>
      <th>8</th>
      <td>64</td>
      <td>West</td>
      <td>300</td>
      <td>1</td>
      <td>1</td>
      <td>0.091673</td>
    </tr>
    <tr>
      <th>9</th>
      <td>86</td>
      <td>West</td>
      <td>280</td>
      <td>1</td>
      <td>1</td>
      <td>0.085561</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The systematic selection method can be implemented with or without replacement. The other <em>samplics</em> algorithms for selecting sample with unequal probablities of selection are Brewer, Hanurav-Vijayan (hv), Murphy, and Rao-Sampford (rs) methods. As shown below, all these sampling techniques can be specified when extentiating a <em>Sample</em> class; then call <em>select()</em> to draw samples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Sample</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-sys&quot;</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Sample</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-sys&quot;</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Sample</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-brewer&quot;</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Sample</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-hv&quot;</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Hanurav-Vijayan method</span>
<span class="n">Sample</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-murphy&quot;</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Sample</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-sampford&quot;</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Rao-Sampford method</span>
</pre></div>
</div>
<p>For example, if we wanted to select the sample using the Rao-Sampford method, we could use the following snippet of code.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>

<span class="n">stage1_sampford</span> <span class="o">=</span> <span class="n">SampleSelection</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;pps-rs&quot;</span><span class="p">,</span> <span class="n">stratification</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">psu_sample_sampford</span> <span class="o">=</span> <span class="n">stage1_sampford</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">],</span>
    <span class="n">psu_sample_size</span><span class="p">,</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">],</span>
    <span class="n">psu_frame</span><span class="p">[</span><span class="s2">&quot;number_households_census&quot;</span><span class="p">],</span>
    <span class="n">to_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sample_only</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

<span class="n">psu_sample_sampford</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_samp_unit</th>
      <th>_stratum</th>
      <th>_mos</th>
      <th>_sample</th>
      <th>_hits</th>
      <th>_probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>North</td>
      <td>105</td>
      <td>0</td>
      <td>0</td>
      <td>0.151625</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>North</td>
      <td>85</td>
      <td>0</td>
      <td>0</td>
      <td>0.122744</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>North</td>
      <td>95</td>
      <td>1</td>
      <td>1</td>
      <td>0.137184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>North</td>
      <td>75</td>
      <td>0</td>
      <td>0</td>
      <td>0.108303</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>North</td>
      <td>120</td>
      <td>0</td>
      <td>0</td>
      <td>0.173285</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>96</td>
      <td>West</td>
      <td>95</td>
      <td>1</td>
      <td>1</td>
      <td>0.029030</td>
    </tr>
    <tr>
      <th>96</th>
      <td>97</td>
      <td>West</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0.012223</td>
    </tr>
    <tr>
      <th>97</th>
      <td>98</td>
      <td>West</td>
      <td>105</td>
      <td>0</td>
      <td>0</td>
      <td>0.032086</td>
    </tr>
    <tr>
      <th>98</th>
      <td>99</td>
      <td>West</td>
      <td>320</td>
      <td>0</td>
      <td>0</td>
      <td>0.097785</td>
    </tr>
    <tr>
      <th>99</th>
      <td>100</td>
      <td>West</td>
      <td>200</td>
      <td>0</td>
      <td>0</td>
      <td>0.061115</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 6 columns</p>
</div></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019-2020, samplics.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>